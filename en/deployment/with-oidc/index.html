
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../with-cognito/">
      
      
        <link rel="next" href="../within-vpc/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.20">
    
    
      
        <title>OIDC - Clickstream Analytics on AWS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#launch-with-openid-connect-oidc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Clickstream Analytics on AWS" class="md-header__button md-logo" aria-label="Clickstream Analytics on AWS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Clickstream Analytics on AWS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OIDC
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="/clickstream-analytics-on-aws/en/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
              
                <li class="md-select__item">
                  <a href="/clickstream-analytics-on-aws/zh/" hreflang="zh" class="md-select__link">
                    简体中文
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/awslabs/clickstream-analytics-on-aws" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../solution-overview/" class="md-tabs__link md-tabs__link--active">
        Implementation Guide
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Clickstream Analytics on AWS" class="md-nav__button md-logo" aria-label="Clickstream Analytics on AWS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Clickstream Analytics on AWS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/awslabs/clickstream-analytics-on-aws" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Implementation Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Implementation Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
          Solution Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_1">
          <span class="md-nav__icon md-icon"></span>
          Solution Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../solution-overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../solution-overview/features-and-benefits/" class="md-nav__link">
        Features and benefits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../solution-overview/use-cases/" class="md-nav__link">
        Use cases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
      
      
      
        <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
          Architecture overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          Architecture overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        Architecture diagram
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../well-architected-pillars/" class="md-nav__link">
        AWS Well-Architected pillars
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
      
      
      
        <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
          Architecture details
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          Architecture details
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../aws-services/" class="md-nav__link">
        AWS services in this solution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture-details/" class="md-nav__link">
        How the solution works
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
      
      
      
        <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
          Plan your deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Plan your deployment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plan-deployment/cost/" class="md-nav__link">
        Cost
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plan-deployment/security/" class="md-nav__link">
        Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plan-deployment/regions/" class="md-nav__link">
        Supported AWS Regions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
          Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          Deployment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../with-cognito/" class="md-nav__link">
        Cognito
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          OIDC
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        OIDC
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-overview" class="md-nav__link">
    Deployment Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-create-oidc-client" class="md-nav__link">
    Step 1. Create OIDC client
  </a>
  
    <nav class="md-nav" aria-label="Step 1. Create OIDC client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-using-cognito-user-pool-from-another-region" class="md-nav__link">
    (Option 1) Using Cognito User Pool from another region
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-authingcn-oidc-client" class="md-nav__link">
    (Option 2) Authing.cn OIDC client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-3-keycloak-oidc-client" class="md-nav__link">
    (Option 3) Keycloak OIDC client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-4-adfs-openid-connect-client" class="md-nav__link">
    (Option 4) ADFS OpenID Connect Client
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-launch-the-stack" class="md-nav__link">
    Step 2. Launch the stack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-update-the-callback-url-of-oidc-client" class="md-nav__link">
    Step 3. Update the callback URL of OIDC client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-setup-dns-resolver" class="md-nav__link">
    Step 4. Setup DNS Resolver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-launch-the-web-console" class="md-nav__link">
    Step 5. Launch the web console
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../within-vpc/" class="md-nav__link">
        Intranet
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
      
      
      
        <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="0">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/1.create-project/" class="md-nav__link">
        Step 1. Create a project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/2.config-pipeline/" class="md-nav__link">
        Step 2. Configure data pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/3.integrate-sdk/" class="md-nav__link">
        Step 3. Integrate SDK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/4.view-dashboard/" class="md-nav__link">
        Step 4. View dashboard
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
      
      
      
        <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="0">
          Pipeline management
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_7">
          <span class="md-nav__icon md-icon"></span>
          Pipeline management
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7_2" >
      
      
      
        <label class="md-nav__link" for="__nav_1_7_2" id="__nav_1_7_2_label" tabindex="0">
          Data ingestion
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_7_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_7_2">
          <span class="md-nav__icon md-icon"></span>
          Data ingestion
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/ingestion/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/ingestion/configure-ingestion-endpoint/" class="md-nav__link">
        Ingeston endpoint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/ingestion/create-data-sink-w-kafka/" class="md-nav__link">
        Data sink - Kafka
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/ingestion/create-data-sink-w-kinesis/" class="md-nav__link">
        Data sink - Kinesis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/ingestion/create-data-sink-w-s3/" class="md-nav__link">
        Data sink - S3
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7_3" >
      
      
      
        <label class="md-nav__link" for="__nav_1_7_3" id="__nav_1_7_3_label" tabindex="0">
          Data processing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_7_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_7_3">
          <span class="md-nav__icon md-icon"></span>
          Data processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/data-processing/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/data-processing/data-schema/" class="md-nav__link">
        Data schema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/data-processing/configure-execution-para/" class="md-nav__link">
        Execution parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/data-processing/configure-plugin/" class="md-nav__link">
        Processing plugin
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/data-modeling/configure-data-modeling/" class="md-nav__link">
        Data modeling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/quicksight/configure-quicksight/" class="md-nav__link">
        Reporting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-mgmt/pipe-mgmt/" class="md-nav__link">
        Pipeline management
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" >
      
      
      
        <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="0">
          SDK manual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_8">
          <span class="md-nav__icon md-icon"></span>
          SDK manual
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sdk-manual/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sdk-manual/android/" class="md-nav__link">
        Android SDK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sdk-manual/swift/" class="md-nav__link">
        Swift SDK
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
      
      
      
        <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="0">
          Dashboards
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9">
          <span class="md-nav__icon md-icon"></span>
          Dashboards
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/acquisition/" class="md-nav__link">
        Acquisition report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/engagement/" class="md-nav__link">
        Engagement report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/activity/" class="md-nav__link">
        Activity report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/retention/" class="md-nav__link">
        Retention report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/device/" class="md-nav__link">
        Device report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/path/" class="md-nav__link">
        Path explorer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/custom-analysis/" class="md-nav__link">
        Custom report
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
      
      
      
        <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="0">
          Additional resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_10">
          <span class="md-nav__icon md-icon"></span>
          Additional resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/upload-ssl-certificate/" class="md-nav__link">
        Upload Certificate
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../uninstall/" class="md-nav__link">
        Uninstall the solution
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_14" >
      
      
      
        <label class="md-nav__link" for="__nav_1_14" id="__nav_1_14_label" tabindex="0">
          Developer guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_14_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_14">
          <span class="md-nav__icon md-icon"></span>
          Developer guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../source/" class="md-nav__link">
        Source code
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../revisions/" class="md-nav__link">
        Revisions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notices/" class="md-nav__link">
        Notices
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-overview" class="md-nav__link">
    Deployment Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-create-oidc-client" class="md-nav__link">
    Step 1. Create OIDC client
  </a>
  
    <nav class="md-nav" aria-label="Step 1. Create OIDC client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-using-cognito-user-pool-from-another-region" class="md-nav__link">
    (Option 1) Using Cognito User Pool from another region
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-authingcn-oidc-client" class="md-nav__link">
    (Option 2) Authing.cn OIDC client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-3-keycloak-oidc-client" class="md-nav__link">
    (Option 3) Keycloak OIDC client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-4-adfs-openid-connect-client" class="md-nav__link">
    (Option 4) ADFS OpenID Connect Client
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-launch-the-stack" class="md-nav__link">
    Step 2. Launch the stack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-update-the-callback-url-of-oidc-client" class="md-nav__link">
    Step 3. Update the callback URL of OIDC client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-setup-dns-resolver" class="md-nav__link">
    Step 4. Setup DNS Resolver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-launch-the-web-console" class="md-nav__link">
    Step 5. Launch the web console
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="launch-with-openid-connect-oidc">Launch with OpenID Connect (OIDC)</h1>
<p><strong>Time to deploy</strong>: Approximately 30 minutes</p>
<h2 id="prerequisites">Prerequisites</h2>
<div class="admonition info">
<p class="admonition-title">Important</p>
<p>The Clickstream Analytics on AWS console is served via CloudFront distribution which is considered as an Internet information service.
If you are deploying the solution in <strong>AWS China Regions</strong>, the domain must have a valid <a href="https://www.amazonaws.cn/en/support/icp/?nc2=h_l2_su">ICP Recordal</a>.</p>
</div>
<ul>
<li>A domain. You will use this domain to access the Clickstream Analytics on AWS console. This is required for AWS China Regions, and is optional for AWS Regions.</li>
<li>An SSL certificate in AWS IAM. The SSL must be associated with the given domain. Follow <a href="../../resources/upload-ssl-certificate/">this guide</a> to upload SSL certificate to IAM. This is required for AWS China Regions only.</li>
</ul>
<h2 id="deployment-overview">Deployment Overview</h2>
<p>Use the following steps to deploy this solution on AWS.</p>
<p><a href="#step-1-create-oidc-client">Step 1. Create OIDC client</a></p>
<p><a href="#step-2-launch-the-stack">Step 2. Launch the stack</a></p>
<p><a href="#step-3-update-the-callback-url-of-oidc-client">Step 3. Update the callback URL of OIDC client</a></p>
<p><a href="#step-4-setup-dns-resolver">Step 4. Set up DNS Resolver</a></p>
<p><a href="#step-5-launch-the-web-console">Step 5. Launch the web console</a></p>
<h2 id="step-1-create-oidc-client">Step 1. Create OIDC client</h2>
<p>You can use different kinds of OpenID Connect providers. This section introduces Option 1 to Option 4.</p>
<ul>
<li>(Option 1) Using Amazon Cognito from another region as OIDC provider.</li>
<li>(Option 2) <a href="https://www.authing.cn/" target="_blank">Authing</a>, which is an example of a third-party authentication provider.</li>
<li>(Option 3) <a href="https://github.com/aws-samples/keycloak-on-aws" target="_blank">Keycloak</a>, which is a solution maintained by AWS and can serve as an authentication identity provider.</li>
<li>(Option 4) <a href="https://docs.microsoft.com/en-us/windows-server/identity/active-directory-federation-services" target="_blank">ADFS</a>, which is a service offered by Microsoft.</li>
<li>(Option 5) Other third-party authentication platforms such as <a href="https://auth0.com/" target="_blank">Auth0</a>.</li>
</ul>
<p>Follow the steps below to create an OIDC client, and obtain the <code>client_id</code> and <code>issuer</code>.</p>
<h3 id="option-1-using-cognito-user-pool-from-another-region">(Option 1) Using Cognito User Pool from another region</h3>
<p>You can leverage the <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools.html">Cognito User Pool</a> in a supported AWS Region as the OIDC provider.</p>
<ol>
<li>Go to the <a href="https://console.aws.amazon.com/cognito/home">Amazon Cognito console</a> in an AWS Region.</li>
<li>Set up the hosted UI with the Amazon Cognito console based on this <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pools-app-integration.html#cognito-user-pools-create-an-app-integration">guide</a>. Please pay attentions to below two configurations<ul>
<li>Choose <strong>Public client</strong> when selecting the <strong>App type</strong>. Make sure don't change the selection <strong>Don't generate a client secret</strong> for <strong>Client secret</strong>.</li>
<li>Add <strong>Profile</strong> in <strong>OpenID Connect scopes</strong>.</li>
</ul>
</li>
<li>
<p>Enter the <strong>Callback URL</strong> and <strong>Sign out URL</strong> using your domain name for Clickstream Analytics on AWS console. 
    !!! info "Note"
        If you're not using custom domain for the console, you don't know the domain name of console. You can input a fake one, for example, <code>clickstream.example.com</code>. Then update it following guidelines in Step 3.</p>
</li>
<li>
<p>If your hosted UI is set up, you should be able to see something like below.</p>
<p><a class="glightbox" href="../../images/OIDC/cognito-hostUI-new.jpeg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="cognito host ui" src="../../images/OIDC/cognito-hostUI-new.jpeg" /></a></p>
</li>
<li>
<p>Save the App client ID, User pool ID and the AWS Region to a file, which will be used later.</p>
<p><a class="glightbox" href="../../images/OIDC/cognito-new-console-clientID.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="cognito client id" src="../../images/OIDC/cognito-new-console-clientID.png" /></a>
   <a class="glightbox" href="../../images/OIDC/cognito-new-console-userpoolID.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="cognito userpool id" src="../../images/OIDC/cognito-new-console-userpoolID.png" /></a></p>
</li>
</ol>
<p>In <a href="#step-2-launch-the-stack">Step 2. Launch the stack</a>, enter the parameters below from your Cognito User Pool.</p>
<ul>
<li><strong>OIDCClientId</strong>: <code>App client ID</code></li>
<li><strong>OIDCProvider</strong>: <code>https://cognito-idp.${REGION}.amazonaws.com/${USER_POOL_ID}</code></li>
</ul>
<h3 id="option-2-authingcn-oidc-client">(Option 2) Authing.cn OIDC client</h3>
<ol>
<li>Go to the <a href="https://console.authing.cn/console" target="_blank">Authing console</a>.</li>
<li>Create a user pool if you don't have one.</li>
<li>Select the user pool.</li>
<li>On the left navigation bar, select <strong>Self-built App</strong> under <strong>Applications</strong>.</li>
<li>Click the <strong>Create</strong> button.</li>
<li>Enter the <strong>Application Name</strong>, and <strong>Subdomain</strong>.</li>
<li>
<p>Save the <code>App ID</code> (that is, <code>client_id</code>) and <code>Issuer</code> to a text file from Endpoint Information, which will be used later.</p>
<p><a class="glightbox" href="../../images/OIDC/authing-endpoint-info.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="authing endpoint info" src="../../images/OIDC/authing-endpoint-info.png" /></a></p>
</li>
<li>
<p>Update the <code>Login Callback URL</code> and <code>Logout Callback URL</code> to your IPC recorded domain name.</p>
</li>
<li>
<p>Set the Authorization Configuration.</p>
<p><a class="glightbox" href="../../images/OIDC/authing-authorization-configuration.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="authing authorization configuration" src="../../images/OIDC/authing-authorization-configuration.png" /></a></p>
</li>
</ol>
<p>You have successfully created an authing self-built application.</p>
<p>In <a href="#step-2-launch-the-stack">Step 2. Launch the stack</a>, enter the parameters below from your Authing user pool.</p>
<ul>
<li><strong>OIDCClientId</strong>: <code>client id</code></li>
<li><strong>OIDCProvider</strong>: <code>Issuer</code></li>
</ul>
<h3 id="option-3-keycloak-oidc-client">(Option 3) Keycloak OIDC client</h3>
<ol>
<li>
<p>Deploy the Keycloak solution in AWS China Regions following <a href="https://aws-samples.github.io/keycloak-on-aws/en/implementation-guide/deployment/" target="_blank">this guide</a>.</p>
</li>
<li>
<p>Sign in to the Keycloak console.</p>
</li>
<li>
<p>On the left navigation bar, select <strong>Add realm</strong>. Skip this step if you already have a realm.</p>
</li>
<li>
<p>Go to the realm setting page. Choose <strong>Endpoints</strong>, and then <strong>OpenID Endpoint Configuration</strong> from the list.</p>
<p><a class="glightbox" href="../../images/OIDC/keycloak-example-realm.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="keycloak realm" src="../../images/OIDC/keycloak-example-realm.png" /></a></p>
</li>
<li>
<p>In the JSON file that opens up in your browser, record the <strong>issuer</strong> value which will be used later.</p>
<p><a class="glightbox" href="../../images/OIDC/keycloak-OIDC-config.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="keycloak oidc config" src="../../images/OIDC/keycloak-OIDC-config.png" /></a></p>
</li>
<li>
<p>Go back to Keycloak console and select <strong>Clients</strong> on the left navigation bar, and choose <strong>Create</strong>.</p>
</li>
<li>Enter a Client ID, which must contain letters (case-insensitive) or numbers. Record the <strong>Client ID</strong> which will be used later.</li>
<li>
<p>Change client settings. Enter <code>http[s]://&lt;Clickstream Analytics on AWS Console domain&gt;/signin</code> in <strong>Valid Redirect URIs</strong>，and enter <code>&lt;console domain&gt;</code> and <code>+</code> in <strong>Web Origins</strong>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you're not using custom domain for the console, the domain name of console is not available yet. You can enter a fake one, for example, <code>clickstream.example.com</code>, and then update it following guidelines in Step 3.</p>
</div>
</li>
<li>
<p>In the Advanced Settings, set the <strong>Access Token Lifespan</strong> to at least 5 minutes.</p>
</li>
<li>Select <strong>Users</strong> on the left navigation bar.</li>
<li>Click <strong>Add user</strong> and enter <strong>Username</strong>.</li>
<li>After the user is created, select <strong>Credentials</strong>, and enter <strong>Password</strong>.</li>
</ol>
<p>In <a href="#step-2-launch-the-stack">Step 2. Launch the stack</a>, enter the parameters below from your Keycloak realm.</p>
<ul>
<li><strong>OIDCClientId</strong>: <code>client id</code></li>
<li><strong>OIDCProvider</strong>: <code>https://&lt;KEYCLOAK_DOMAIN_NAME&gt;/auth/realms/&lt;REALM_NAME&gt;</code></li>
</ul>
<h3 id="option-4-adfs-openid-connect-client">(Option 4) ADFS OpenID Connect Client</h3>
<ol>
<li>Make sure your ADFS is installed. For information about how to install ADFS, refer to <a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-fs/deployment/ad-fs-deployment-guide">this guide</a>.</li>
<li>Make sure you can log in to the ADFS Sign On page. The URL should be <code>https://adfs.domain.com/adfs/ls/idpinitiatedSignOn.aspx</code>, and you need to replace <strong>adfs.domain.com</strong> with your real ADFS domain.</li>
<li>Log on your <strong>Domain Controller</strong>, and open <strong>Active Directory Users and Computers</strong>.</li>
<li>
<p>Create a <strong>Security Group</strong> for Clickstream Analytics on AWS Users, and add your planned Clickstream Analytics on AWS users to this Security Group.</p>
</li>
<li>
<p>Log on to ADFS server, and open <strong>ADFS Management</strong>.</p>
</li>
<li>
<p>Right click <strong>Application Groups</strong>, choose <strong>Application Group</strong>, and enter the name for the Application Group. Select <strong>Web browser accessing a web application</strong> option under <strong>Client-Server Applications</strong>, and choose <strong>Next</strong>.</p>
</li>
<li>
<p>Record the <strong>Client Identifier</strong> (<code>client_id</code>) under <strong>Redirect URI</strong>, enter your Clickstream Analytics on AWS domain (for example, <code>xx.example.com</code>), and choose <strong>Add</strong>, and then choose <strong>Next</strong>.</p>
</li>
<li>
<p>In the <strong>Choose Access Control Policy</strong> window, select <strong>Permit specific group</strong>, choose <strong>parameters</strong> under Policy part, add the created Security Group in Step 4, then click <strong>Next</strong>. You can configure other access control policy based on your requirements.</p>
</li>
<li>
<p>Under Summary window, choose <strong>Next</strong>, and choose <strong>Close</strong>.</p>
</li>
<li>
<p>Open the Windows PowerShell on ADFS Server, and run the following commands to configure ADFS to allow CORS for your planned URL.</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Set-AdfsResponseHeaders<span class="w"> </span>-EnableCORS<span class="w"> </span><span class="nv">$true</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Set-AdfsResponseHeaders<span class="w"> </span>-CORSTrustedOrigins<span class="w"> </span>https://&lt;your-clickstream-analytics-on-aws-domain&gt;
</span></code></pre></div>
</li>
<li>
<p>Under Windows PowerShell on ADFS server, run the following command to get the Issuer (<code>issuer</code>) of ADFS, which is similar to <code>https://adfs.example.com/adfs</code>.</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Get-ADFSProperties<span class="w"> </span><span class="p">|</span><span class="w"> </span>Select<span class="w"> </span>IdTokenIssuer
</span></code></pre></div>
<p><a class="glightbox" href="../../images/OIDC/adfs-9.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="get adfs properties" src="../../images/OIDC/adfs-9.png" /></a></p>
</li>
</ol>
<p>In <a href="#step-2-launch-the-stack">Step 2. Launch the stack</a>, enter the parameters below from your ADFS server.</p>
<ul>
<li><strong>OIDCClientId</strong>: <code>client id</code></li>
<li><strong>OIDCProvider</strong>: Get the server of the issuer from above step 11</li>
</ul>
<h2 id="step-2-launch-the-stack">Step 2. Launch the stack</h2>
<ol>
<li>
<p>Sign in to the <a href="https://console.aws.amazon.com/">AWS Management Console</a> and use the button below to launch the AWS CloudFormation template.</p>
<table>
<thead>
<tr>
<th></th>
<th>Launch in AWS Console</th>
</tr>
</thead>
<tbody>
<tr>
<td>Launch in AWS Regions</td>
<td><a href="https://console.aws.amazon.com/cloudformation/home#/stacks/new?templateURL=https://solutions-reference.s3.amazonaws.com/clickstream-analytics-on-aws/latest/cloudfront-s3-control-plane-stack-global-oidc.template.json" target="_blank"><img alt="Launch Stack" src="../../images/launch-stack.webp" /></a></td>
</tr>
<tr>
<td>Launch with custom domain in AWS Regions</td>
<td><a href="https://console.aws.amazon.com/cloudformation/home#/stacks/new?templateURL=https://solutions-reference.s3.amazonaws.com/clickstream-analytics-on-aws/latest/cloudfront-s3-control-plane-stack-global-customdomain-oidc.template.json" target="_blank"><img alt="Launch Stack" src="../../images/launch-stack.webp" /></a></td>
</tr>
<tr>
<td>Launch in AWS China Regions</td>
<td><a href="https://console.amazonaws.cn/cloudformation/home#/stacks/new?templateURL=https://aws-gcr-solutions.s3.cn-north-1.amazonaws.com.cn/clickstream-analytics-on-aws/latest/cn/cloudfront-s3-control-plane-stack-cn.template.json" target="_blank"><img alt="Launch Stack" src="../../images/launch-stack.webp" /></a></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>The template is launched in the default region after you log in to the console. To launch the Clickstream Analytics on AWS solution in a different AWS Region, use the Region selector in the console navigation bar.</p>
</li>
<li>On the <strong>Create stack</strong> page, verify that the correct template URL shows in the <strong>Amazon S3 URL</strong> text box and choose <strong>Next</strong>.</li>
<li>On the <strong>Specify stack details</strong> page, assign a name to your solution stack. For information about naming character limitations, refer to <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_iam-limits.html" target="_blank">IAM and AWS STS quotas</a> in the <em>AWS Identity and Access Management User Guide</em>.</li>
<li>
<p>Under <strong>Parameters</strong>, review the parameters for the template and modify them as necessary.</p>
<ul>
<li>
<p>This solution uses the following parameters:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>OIDCClientId</td>
<td><code>&lt;Requires input&gt;</code></td>
<td>OpenID Connect client Id.</td>
</tr>
<tr>
<td>OIDCProvider</td>
<td><code>&lt;Requires input&gt;</code></td>
<td>OpenID Connect provider issuer. The issuer must begin with <code>https://</code></td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Important</p>
<p><!-- BEGIN INCLUDE tls-note.md -->
By default, this deployment uses TLSv1.0 and TLSv1.1 in CloudFront. However, we recommend that you manually configure CloudFront to use the more secure TLSv1.2/TLSv1.3 and apply for a certificate and custom domain to enable this. We highly recommend that you update your TLS configuration and cipher suite selection according to the following recommendations:</p>
<ul>
<li><strong>Transport Layer Security Protocol</strong>: Upgrade to TLSv1.2 or higher</li>
<li><strong>Key Exchange</strong>: ECDHE</li>
<li><strong>Block Cipher Mode of Operation</strong>: GCM</li>
<li><strong>Authentication</strong>: ECDSA</li>
<li><strong>Encryption Cipher</strong>: AES256</li>
<li><strong>Message Authentication</strong>: SHA(256/384/any hash function except for SHA1)</li>
</ul>
<p>Such as TLSv1.2_2021 can meet the above recommendations.
<!-- END INCLUDE --></p>
</div>
</li>
<li>
<p>If you are launching the solution with custom domain in AWS Regions, this solution has the following additional parameters:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hosted Zone ID</td>
<td><code>&lt;Requires input&gt;</code></td>
<td>Choose the public hosted zone ID of Amazon Route 53.</td>
</tr>
<tr>
<td>Hosted Zone Name</td>
<td><code>&lt;Requires input&gt;</code></td>
<td>The domain name of the public hosted zone, for example, <code>example.com</code>.</td>
</tr>
<tr>
<td>Record Name</td>
<td><code>&lt;Requires input&gt;</code></td>
<td>The sub name (as known as record name in R53) of the domain name of console. For example, enter <code>clickstream</code> if you want to use custom domain <code>clickstream.example.com</code> for the console.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>If you are launching the solution in AWS China Regions, this solution has the following additional parameters:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Domain</td>
<td><code>&lt;Requires input&gt;</code></td>
<td>Custom domain for Clickstream Analytics on AWS console. Do NOT add <code>http(s)</code> prefix.</td>
</tr>
<tr>
<td>IamCertificateID</td>
<td><code>&lt;Requires input&gt;</code></td>
<td>The ID of the SSL certificate in IAM. The ID is composed of 21 characters of capital letters and digits. Use the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_server-certs.html#list-server-certificates" target="_blank"><code>list-server-certificates</code></a> command to retrieve the ID.</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
<li>
<p>Choose <strong>Next</strong>.</p>
</li>
<li>On the <strong>Configure stack options</strong> page, choose <strong>Next</strong>.</li>
<li>On the <strong>Review</strong> page, review and confirm the settings. Check the box acknowledging that the template creates AWS Identity and Access Management (IAM) resources.</li>
<li>Choose <strong>Create stack</strong>  to deploy the stack.</li>
</ol>
<p>You can view the status of the stack in the AWS CloudFormation console in the <strong>Status</strong> column. You should receive a <strong>CREATE_COMPLETE</strong> status in approximately 10 minutes.</p>
<h2 id="step-3-update-the-callback-url-of-oidc-client">Step 3. Update the callback URL of OIDC client</h2>
<div class="admonition info">
<p class="admonition-title">Important</p>
<p>If you don't deploy stack with custom domain, you must complete below steps.</p>
</div>
<ol>
<li>Sign in to the <a href="https://console.aws.amazon.com/cloudformation/" target="_blank">AWS CloudFormation console</a>.</li>
<li>Select the solution's stack.</li>
<li>Choose the <strong>Outputs</strong> tab.</li>
<li>Obtain the <strong>ControlPlaneURL</strong> as the endpoint.</li>
<li>Update or add the callback URL to your OIDC.<ol>
<li>For Cognito, add or update the url in <strong>Allowed callback URL</strong> of your client with value <code>${ControlPlaneURL}/signin</code>. <strong>NOTE</strong>: The url must start with <code>https://</code>.</li>
<li>For Keycloak, add or update the url in <strong>Valid Redirect URIs</strong> of your client with value <code>${ControlPlaneURL}/signin</code>.</li>
<li>For Authing.cn, add or update the url in <strong>Login Callback URL</strong> of <strong>Authentication Configuration</strong>.</li>
</ol>
</li>
</ol>
<h2 id="step-4-setup-dns-resolver">Step 4. Setup DNS Resolver</h2>
<div class="admonition info">
<p class="admonition-title">Important</p>
<p>If you deploy stack in AWS Regions, you can skip this step.</p>
</div>
<p>This solution provisions a CloudFront distribution that gives you access to the Clickstream Analytics on AWS console.</p>
<ol>
<li>Sign in to the <a href="https://console.aws.amazon.com/cloudformation/" target="_blank">AWS CloudFormation console</a>.</li>
<li>Select the solution's stack.</li>
<li>Choose the <strong>Outputs</strong> tab.</li>
<li>Obtain the <strong>ControlPlaneURL</strong> and <strong>CloudFrontDomainName</strong>.</li>
<li>Create a CNAME record for <strong>ControlPlaneURL</strong> in DNS resolver, which points to the domain <strong>CloudFrontDomainName</strong> obtained in previous step.</li>
</ol>
<h2 id="step-5-launch-the-web-console">Step 5. Launch the web console</h2>
<div class="admonition info">
<p class="admonition-title">Important</p>
<p>Your login credentials is managed by the OIDC provider. Before signing in to the Clickstream Analytics on AWS console, make sure you have created at least one user in the OIDC provider's user pool.</p>
</div>
<ol>
<li>Use the previously assigned domain name or the generated <strong>ControlPlaneURL</strong> in a web browser.</li>
<li>Choose <strong>Sign In</strong>, and navigate to OIDC provider.</li>
<li>Enter sign-in credentials. You may be asked to change your default password for first-time login, which depends on your OIDC provider's policy.</li>
<li>After the verification is complete, the system opens the Clickstream Analytics on AWS web console.</li>
</ol>
<p>Once you have logged into the Clickstream Analytics on AWS console, you can start to <a href="../../getting-started/1.create-project/">create a project</a> for your applications.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "search.suggest", "search.highlight", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>